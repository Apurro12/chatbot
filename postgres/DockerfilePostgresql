FROM postgres:16

RUN apt-get update
# install gcc
RUN echo yes | apt-get install build-essential
# dev files not included in vanilla postgres image
RUN echo yes | apt-get install postgresql-server-dev-16

WORKDIR /tmp

RUN echo yes | apt-get install git-all
RUN git clone --branch v0.7.4 https://github.com/pgvector/pgvector.git
RUN apt-get install make
WORKDIR /tmp/pgvector
RUN make 
RUN make install

COPY docker-entrypoint-initdb.d .